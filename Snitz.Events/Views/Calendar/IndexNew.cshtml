@using System.Globalization
@using System.Resources
@using Microsoft.AspNetCore.Http
@model dynamic

@{
    Layout = "Layout";
    ViewBag.Title = SnitzConfig.ForumTitle + " | " + @Localizer["calTitle"];
    string[] rtlLangs = new string[] { "ar", "arc", "dv", "fa", "ha", "khw", "ks", "ku", "ps", "ur", "yi", "he" };

    //check the culture so we can set the page direction and language
    var cookielang = SnitzCookie.GetCookieValue("CookieLang");
    CultureInfo ci = CultureInfo.CurrentUICulture;
    string clang = ci.TwoLetterISOLanguageName;

    if (cookielang != null)
    {
        var cultureInfo = new CultureInfo(cookielang);
        CultureInfo.CurrentUICulture = cultureInfo;
        clang = cultureInfo.TwoLetterISOLanguageName;
    }
    Context.Session.SetString("culture", clang);
    bool isRighToLeft = rtlLangs.Contains(clang);


    clang = clang + ".js";
}

@section Styles {
<style>

  body {
    margin: 40px 10px;
    padding: 0;
    font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
    font-size: 14px;
  }

  #calendar {
    max-width: 1200px;
    margin: 0 auto;
  }

</style>
}
<div class="chunk-main">
    <snitz-breadcrumb show-filter="false"></snitz-breadcrumb>
    <h5>@Localizer["calTitle"]</h5>
    <hr class="title" />
    </div>
<div id='calendar'></div>

@section Scripts {
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js'></script>
    <script>

        document.addEventListener('DOMContentLoaded', function() {
            var calendarEl = document.getElementById('calendar');

            var url = SnitzVars.baseUrl + "/Calendar/GetCalendarEvents/" 
            var holidayUrl = SnitzVars.baseUrl + "/Calendar/GetHolidays/gbr";
            var eventsUrl = SnitzVars.baseUrl + "/Events/GetClubCalendarEvents/-1?old=0&calendar=1";
            var birthdayUrl = SnitzVars.baseUrl + "/Calendar/GetBirthDays";

          var calendar = new FullCalendar.Calendar(calendarEl, {
            headerToolbar: {
              left: 'prev,next today',
              center: 'title',
              right: 'multiMonthYear,dayGridMonth,timeGridWeek'
            },
            initialView: 'month',
            lang: SnitzVars.forumlang,
            //initialDate: '2023-01-12',
            editable: true,
            selectable: true,
            dayMaxEvents: true, // allow "more" link when too many events
            // multiMonthMaxColumns: 1, // guarantee single column
            // showNonCurrentDates: true,
            // fixedWeekCount: false,
            // businessHours: true,
            // weekends: false,
            dateFormat: 'dd/MM/yy',
            timeFormat: 'HH:mm',
            eventSources: [
                { url: url },
                { url: eventsUrl },
                { url: holidayUrl },
                { url: birthdayUrl }
            ]
          });

          calendar.render();
        });

    </script>
}
